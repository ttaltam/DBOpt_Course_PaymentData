### Оценка затрат на выполнение операций расчета балансов:

#### Таблица Payment:
- При добавлении данных, 82% ресурсов направлены на добавление кластерного индекса, остальные ресурсы, превышающие 0, составляют в среднем 4%.
- **План выполнения:** PlanOfPaimentInsert

#### Таблица PaymentParticipant:
- При добавлении данных, 100% ресурсов используются на добавление кластерного индекса.
- **План выполнения:** PlanOfPaymentParticipantInsert

#### Таблица Project:
- При добавлении данных, 84% ресурсов направлены на добавление кластерного индекса, остальные ресурсы, превышающие 0, составляют в среднем 5%.
- **План выполнения:** PlanOfProjectInsert

#### CalculateBalanceByMaterial:
- Самые затратные операции - добавление кластерного индекса (46%, 46%).

#### CalculateBalanceParticipantBalance:
- Самые затратные операции - добавление кластерного индекса (46%, 47%).

### Предложенный сценарий оптимизации:

Очевидно, что для бухгалтера-оператора нет необходимости пересчитывать баланс, поэтому можно "накопить" его данные и при работе аналитика посчитать введенные данные.

#### Способы реализации предложенной методики:

1. Реализовать разные версии клиентов, при которых у аналитика и оператора будут выполняться разные запросы к БД - соответственно, у аналитика сразу с подсчетом баланса, у оператора без.
2. Создать дополнительную таблицу, которую можно использовать как "буфер". Например, при накоплении определенного количества введенных оператором транзакций, сработает триггер, пересчитывающий балансы.
3. Использование сессии. Таким образом, оператор будет вносить данные, и после окончания его работы команды будут выполняться и высчитываться балансы. Сессия на этом закончится. Аналитик начнет свою сессию и будет работать с готовыми данными.

### Оценка недостатков предлагаемого сценария:

1. Реализация "похожих" запросов или нескольких клиентов может привести к потере времени, особенно если пересчитывать балансы во время начала работы аналитика.
2. Усложнение структуры базы данных. Необходимость в экспериментах для подбора оптимального значения n (количества транзакций для пересчета). В момент работы аналитика нужно либо пересчитывать все, что накопилось в буфере, либо он будет использовать неактуальные данные.
3. Возможна ситуация одновременной работы, при которой аналитик не будет иметь свежих данных (хотя отставать будет всего на 1 сессию).